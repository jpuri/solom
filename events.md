## Events

### Events and Logging

Solidity provides a logging functionality. Events are an abstration over this. When events are called their arguments are stored in transaction log. These logs are associated with the address of contract and incorporated into the blockchain. They are accessible as long as block is accessible.

Applications can subscribe and listen to these events. The log and its event data is not accessible from within contracts. But contracts can request for Merkle proof of logs.

### Declaring events

Events are declared in a contract and are inheritable. An example of events is:

```
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.4.21 <0.9.0;

contract ClientReceipt {
    event Deposit(
        address indexed from,
        bytes32 indexed id,
        uint value
    );

    function deposit(bytes32 id) public payable {
        // Events are emitted using `emit`, followed by
        // the name of the event and the arguments
        // (if any) in parentheses. Any such invocation
        // (even deeply nested) can be detected from
        // the JavaScript API by filtering for `Deposit`.
        emit Deposit(msg.sender, id, msg.value);
    }
}
```

### Parts of Log

Log has 2 parts:

1. topics
2. data

Attribute `indexed` can be added upto 2 parameters in the Event, these parameters are added to special data structures called `topics`. All parameters without `indexed` attrubute are `abi` encoded in the `data` part of the log.

Topics allow for searching and filtering events, events can also be filtered by address of the contract that emitted them.

### Using events in JS code

The use of above example event in JS api:

```
var abi = /* abi as generated by the compiler */;
var ClientReceipt = web3.eth.contract(abi);
var clientReceipt = ClientReceipt.at("0x1234...ab67" /* address */);

var depositEvent = clientReceipt.Deposit();

// watch for changes
depositEvent.watch(function(error, result){
    // result contains non-indexed arguments and topics
    // given to the `Deposit` call.
    if (!error)
        console.log(result);
});
```
